<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Jekyll環境をDockerで構築したよ - Razl-Dazl</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Jekyll環境をDockerで構築したよ" />
<meta property="og:description" content="※このサイトはJekyllで生成しているのですが、作成した記事のプレビューを見るにはRubyが必要なので少し厄介です
PCを初期化したり買い換える度にrbenv入れて〜とかやるのは少しだるい
環境を汚すのはあまり好きじゃないのでDockerを使って環境を作ることにしました" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://razl-dazl.github.io/posts/2021/12/jekyll-docker-compose/" />
<meta property="article:published_time" content="2021-12-09T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-12-09T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Jekyll環境をDockerで構築したよ"/>
<meta name="twitter:description" content="※このサイトはJekyllで生成しているのですが、作成した記事のプレビューを見るにはRubyが必要なので少し厄介です
PCを初期化したり買い換える度にrbenv入れて〜とかやるのは少しだるい
環境を汚すのはあまり好きじゃないのでDockerを使って環境を作ることにしました"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100&family=Raleway:wght@100;200&display=swap" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://razl-dazl.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://razl-dazl.github.io/css/main.css" /><link rel="stylesheet" type="text/css" href="https://razl-dazl.github.io/css/dark.css" media="(prefers-color-scheme: dark)" />

	
	<script src="https://razl-dazl.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	
	<h1 class="site-title"><a href="https://razl-dazl.github.io/">Razl-Dazl</a></h1>
	<div class="site-description"><nav class="nav social">
			<ul class="flat"></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">home</a>
			</li>
			
			<li>
				<a href="/tags/">tags</a>
			</li>
			
			<li>
				<a href="/posts/">all posts</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			
			<div class="eyecatch">
				<img src="/thumbnails/code.webp">
				
			</div>
			
			<h1 class="title">Jekyll環境をDockerで構築したよ</h1>
			<div class="meta">Posted at &mdash; Dec 9, 2021</div>
		</div>

		<div class="markdown">
			<p><del>※このサイトはJekyllで生成しているのですが</del>、作成した記事のプレビューを見るにはRubyが必要なので少し厄介です</p>
<p>PCを初期化したり買い換える度にrbenv入れて〜とかやるのは少しだるい</p>
<p>環境を汚すのはあまり好きじゃないのでDockerを使って環境を作ることにしました</p>
<p>DockerでJekyllを使う方法なんてググればいくらでも前例が出てくるんですけど、折角なので自己流の手順を書いていきます</p>
<p>※とか言った側からHugoに手を出してしまい、Jekyllを置き換えてしまった&hellip;でも記事は残しておきます</p>
<hr>
<h2 id="下準備">下準備</h2>
<p>今回はdocker-composeコマンドを使用します</p>
<p>GUI版Docker(Docker Desktop)を導入していれば、特に追加で入れるものはありません</p>
<p>CLI版のdockerの場合はdocker-composeを別で導入する必要があるので、その辺りは調べてみてください</p>
<p>MacとWindowsはGUI版が存在するので大体の人は大丈夫だと思います</p>
<hr>
<h2 id="構成">構成</h2>
<p>your.domain.comより下がGitHubのリポジトリに格納する対象部分です</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">work_dir/
├─ docker-compose.yml
├─ your.domain.com/
│  ├─ 404.md
│  ├─ index.md
│  └─ etc...
└─ run.sh
</code></pre></div><hr>
<h2 id="docker-composeyml作成">docker-compose.yml作成</h2>
<p>Dockerの設定ファイルを作成</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">version: &#39;3&#39;
services:
  jekyll:
    image: jekyll/jekyll
    volumes:
      - ./your.domain.com:/your.domain.com
    working_dir: /your.domain.com
    command: jekyll s
    ports:
      - &#34;14000:4000&#34;
</code></pre></div><ul>
<li>
<p>images</p>
<ul>
<li>元となるイメージファイルを指定する</li>
<li>公式でJekyllのものがあるので流用 <a href="https://hub.docker.com/r/jekyll/jekyll/">https://hub.docker.com/r/jekyll/jekyll/</a></li>
</ul>
</li>
<li>
<p>volumes</p>
<ul>
<li>マウントする領域のパスを指定</li>
<li>ホストマシンのパス:Dockerコンテナのパス 形式で指定</li>
</ul>
</li>
<li>
<p>working_dir</p>
<ul>
<li>コンテナでのカレントディレクトリ</li>
</ul>
</li>
<li>
<p>command</p>
<ul>
<li>コンテナが起動した際に実行するコマンド</li>
<li>自動的にJekyllのプレビュー機能が使えるよう指定しました</li>
<li>この欄を削ると自動では起動しなくなるので、その場合はDocker Desktopで起動中のコンテナからCLIを選択し、コマンドを打ち込む必要があります</li>
</ul>
</li>
<li>
<p>ports</p>
<ul>
<li>ホストマシンのポート:コンテナのポート 形式で指定</li>
<li><code>jekyll s</code>した際にデフォルトでは4000番ポートを使用してサーバが立ち上がるようなので、コンテナ側は4000を指定</li>
<li>ホスト側は好きなポートで。とりあえず今回は14000</li>
</ul>
</li>
</ul>
<hr>
<h2 id="実行用ファイル作成">実行用ファイル作成</h2>
<p>docker-composeのコマンドって何か忘れやすいのでシェルスクリプトとしてメモっておきます&hellip;</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">docker-compose up --build
</code></pre></div><p>内容はこの一行だけ</p>
<hr>
<h2 id="起動">起動</h2>
<p>ターミナルやPowerShellでrun.shを実行すれば後は勝手に処理が進みます</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">cd work_dir
./run.sh
</code></pre></div><p>ブラウザを立ち上げてlocalhost:14000にアクセスすればサイトのプレビューが確認できます</p>
<p>以上のファイルをiCloudにバックアップ</p>
<p>これでいつでも環境が簡単に復元できるってわけ</p>
<p>去年までDockerのDの字も知らなかったけど使えば使うほど便利だな〜と&hellip;</p>
<p>最近は仕事でDockerばっかり触っているので、事ある毎にDockerの使い道を考えています。公私混同。さいあく</p>
		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/tags/docker">Docker</a></li>
								
								<li><a href="/tags/jekyll">Jekyll</a></li>
								
							</ul>
					</nav>
				
			
		</div>
		<div class="about section">
			
				<h2 class="section-header">Author@zakuro</h2>
				<div class="content-wrapper">
					<img src ="/img/my-icon.jpg">
					<div class="content"><p>SE辞めた/Kotlin/Python/Hugo/Obsidian</p>
<p>好きなもの: OSS、個人サイト、クロスプラットフォーム</p>
<p>嫌いなもの: サブスク、いかがでしたかブログ、ビッグテックの囲い込み</p>
<p>生息地: <a href="https://mistodon.cloud/@z">mastodon</a></p>
</div>
				</div>
			
		</div>
	</div>
	
	<div class="footer wrapper">
	<nav class="nav">
		<div> razl-dazl.github.io |  <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>




</body>
</html>
